{
  "file_name": "health_scanner_ai.py",
  "file_path": "C:\\Users\\lyndz\\Downloads\\hypercode PROJECT\\hypercode\\hypercode\\src\\utils\\health_scanner_ai.py",
  "file_size": 9220,
  "created": "2025-11-26T23:37:35.696135",
  "modified": "2025-12-04T00:57:05.505897",
  "file_type": "code",
  "content_hash": "f9f1c5f4f0b197e18b4f778ad6c56ac9",
  "content_type": "text",
  "content": "#!/usr/bin/env python3\n\"\"\"\nHyperCode Health Scanner with Perplexity AI Integration\nUses Perplexity API to analyze project health and provide intelligent recommendations\n\"\"\"\n\nimport json\nimport sys\nfrom pathlib import Path\nfrom typing import Dict\n\n# Add src to path\nsys.path.insert(0, str(Path(__file__).parent / \"src\"))\n\nfrom hypercode.perplexity_client import PerplexityClient\n\n\nclass HealthScannerAI:\n    \"\"\"AI-powered health scanner for HyperCode project\"\"\"\n\n    def __init__(self):\n        self.perplexity = PerplexityClient()\n        self.health_scan_results = {}\n\n    def analyze_project_structure(self) -> Dict:\n        \"\"\"Analyze project structure and identify health issues\"\"\"\n        print(\"Analyzing project structure...\")\n\n        base_path = Path(\".\")\n        analysis = {\n            \"structure_score\": 0,\n            \"issues\": [],\n            \"recommendations\": [],\n            \"files_analyzed\": 0,\n        }\n\n        # Check for essential files\n        essential_files = [\n            \"README.md\",\n            \"pyproject.toml\",\n            \"requirements.txt\",\n            \".gitignore\",\n            \"LICENSE\",\n            \"CONTRIBUTING.md\",\n        ]\n\n        for file in essential_files:\n            if (base_path / file).exists():\n                analysis[\"structure_score\"] += 10\n            else:\n                analysis[\"issues\"].append(f\"Missing essential file: {file}\")\n                analysis[\"recommendations\"].append(f\"Create {file}\")\n\n        # Analyze directory structure\n        important_dirs = [\"src\", \"tests\", \"docs\", \".github\"]\n        for dir_name in important_dirs:\n            if (base_path / dir_name).exists() and (base_path / dir_name).is_dir():\n                analysis[\"structure_score\"] += 5\n            else:\n                analysis[\"issues\"].append(f\"Missing important directory: {dir_name}\")\n\n        # Count Python files\n        py_files = list(base_path.rglob(\"*.py\"))\n        analysis[\"files_analyzed\"] = len(py_files)\n\n        return analysis\n\n    def analyze_dependencies(self) -> Dict:\n        \"\"\"Analyze dependency management\"\"\"\n        print(\"Analyzing dependencies...\")\n\n        analysis = {\n            \"dependency_score\": 0,\n            \"issues\": [],\n            \"recommendations\": [],\n            \"dependencies_found\": [],\n        }\n\n        # Check pyproject.toml\n        pyproject_path = Path(\"pyproject.toml\")\n        if pyproject_path.exists():\n            try:\n                with open(pyproject_path, \"r\") as f:\n                    content = f.read()\n                    if \"dependencies = [\" in content:\n                        analysis[\"dependency_score\"] += 20\n                    else:\n                        analysis[\"issues\"].append(\n                            \"Dependencies not properly defined in pyproject.toml\"\n                        )\n                        analysis[\"recommendations\"].append(\n                            \"Add explicit dependencies to pyproject.toml\"\n                        )\n            except Exception as e:\n                analysis[\"issues\"].append(f\"Error reading pyproject.toml: {e}\")\n        else:\n            analysis[\"issues\"].append(\"No pyproject.toml found\")\n            analysis[\"recommendations\"].append(\n                \"Create pyproject.toml with proper dependencies\"\n            )\n\n        # Check requirements files\n        req_files = [\"requirements.txt\", \"requirements-dev.txt\"]\n        for req_file in req_files:\n            if Path(req_file).exists():\n                analysis[\"dependency_score\"] += 10\n\n        return analysis\n\n    def analyze_security(self) -> Dict:\n        \"\"\"Analyze security configuration\"\"\"\n        print(\"Analyzing security setup...\")\n\n        analysis = {\"security_score\": 0, \"issues\": [], \"recommendations\": []}\n\n        # Check for security files\n        security_files = [\n            \".github/workflows/ci.yml\",\n            \".github/dependabot.yml\",\n            \"SECURITY.md\",\n            \".env.example\",\n        ]\n\n        for sec_file in security_files:\n            if Path(sec_file).exists():\n                analysis[\"security_score\"] += 10\n            else:\n                analysis[\"issues\"].append(f\"Missing security configuration: {sec_file}\")\n                analysis[\"recommendations\"].append(f\"Create {sec_file}\")\n\n        # Check .env file is not committed\n        if Path(\".env\").exists():\n            with open(\".gitignore\", \"r\") as f:\n                gitignore_content = f.read()\n                if \".env\" in gitignore_content:\n                    analysis[\"security_score\"] += 15\n                else:\n                    analysis[\"issues\"].append(\".env file not in .gitignore\")\n                    analysis[\"recommendations\"].append(\"Add .env to .gitignore\")\n\n        return analysis\n\n    def get_ai_recommendations(self, health_data: Dict) -> str:\n        \"\"\"Get AI-powered recommendations based on health scan\"\"\"\n        print(\"Getting AI recommendations from Perplexity...\")\n\n        prompt = f\"\"\"\n        You are an expert software development consultant analyzing the HyperCode project health.\n\n        Based on this health scan data, provide specific, actionable recommendations:\n\n        {json.dumps(health_data, indent=2)}\n\n        Focus on:\n        1. Critical issues that need immediate attention\n        2. Medium-term improvements for project health\n        3. Long-term strategic recommendations\n        4. Prioritization of tasks based on impact vs effort\n\n        Provide recommendations in a clear, structured format with specific file paths and actions.\n        \"\"\"\n\n        response = self.perplexity.query(prompt)\n\n        if \"choices\" in response and response[\"choices\"]:\n            return response[\"choices\"][0][\"message\"][\"content\"]\n        else:\n            return \"Failed to get AI recommendations\"\n\n    def run_full_scan(self) -> Dict:\n        \"\"\"Run complete health scan with AI analysis\"\"\"\n        print(\"Starting HyperCode Health Scan with AI Analysis...\")\n        print(\"=\" * 60)\n\n        # Run analyses\n        structure_analysis = self.analyze_project_structure()\n        dependency_analysis = self.analyze_dependencies()\n        security_analysis = self.analyze_security()\n\n        # Compile results\n        health_data = {\n            \"project_structure\": structure_analysis,\n            \"dependencies\": dependency_analysis,\n            \"security\": security_analysis,\n            \"overall_score\": (\n                structure_analysis[\"structure_score\"]\n                + dependency_analysis[\"dependency_score\"]\n                + security_analysis[\"security_score\"]\n            ),\n        }\n\n        # Get AI recommendations\n        ai_recommendations = self.get_ai_recommendations(health_data)\n\n        # Final report\n        report = {\n            \"scan_timestamp\": str(Path.cwd()),\n            \"health_data\": health_data,\n            \"ai_recommendations\": ai_recommendations,\n            \"summary\": {\n                \"overall_score\": health_data[\"overall_score\"],\n                \"total_issues\": len(\n                    structure_analysis[\"issues\"]\n                    + dependency_analysis[\"issues\"]\n                    + security_analysis[\"issues\"]\n                ),\n                \"critical_areas\": [],\n            },\n        }\n\n        # Identify critical areas\n        if structure_analysis[\"structure_score\"] < 30:\n            report[\"summary\"][\"critical_areas\"].append(\"Project Structure\")\n        if dependency_analysis[\"dependency_score\"] < 20:\n            report[\"summary\"][\"critical_areas\"].append(\"Dependency Management\")\n        if security_analysis[\"security_score\"] < 30:\n            report[\"summary\"][\"critical_areas\"].append(\"Security Configuration\")\n\n        return report\n\n    def save_report(self, report: Dict, filename: str = \"health_scan_report.json\"):\n        \"\"\"Save health scan report to file\"\"\"\n        with open(filename, \"w\") as f:\n            json.dump(report, f, indent=2)\n        print(f\"Health scan report saved to {filename}\")\n\n    def print_summary(self, report: Dict):\n        \"\"\"Print a summary of the health scan\"\"\"\n        print(\"\\n\" + \"=\" * 60)\n        print(\"HYPERCODE HEALTH SCAN SUMMARY\")\n        print(\"=\" * 60)\n\n        summary = report[\"summary\"]\n        print(f\"Overall Score: {summary['overall_score']}/100\")\n        print(f\"Total Issues Found: {summary['total_issues']}\")\n\n        if summary[\"critical_areas\"]:\n            print(f\"Critical Areas: {', '.join(summary['critical_areas'])}\")\n        else:\n            print(\"Critical Areas: None - Good job!\")\n\n        print(\"\\nAI RECOMMENDATIONS:\")\n        print(\"-\" * 40)\n        print(report[\"ai_recommendations\"])\n\n\ndef main():\n    \"\"\"Main function to run the health scanner\"\"\"\n    scanner = HealthScannerAI()\n\n    # Run the scan\n    report = scanner.run_full_scan()\n\n    # Save and display results\n    scanner.save_report(report)\n    scanner.print_summary(report)\n\n    print(\"\\n[SUCCESS] Health scan completed!\")\n\n\nif __name__ == \"__main__\":\n    main()\n",
  "metadata": {},
  "relative_path": "hypercode\\src\\utils\\health_scanner_ai.py",
  "id": "3c4b89807e9b7e03729bc1543a7316de"
}