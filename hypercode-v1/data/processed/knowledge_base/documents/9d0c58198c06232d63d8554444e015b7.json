{
  "file_name": "perplexity_client.py",
  "file_path": "C:\\Users\\lyndz\\Downloads\\hypercode PROJECT\\hypercode\\src\\hypercode\\perplexity_client.py",
  "file_size": 2700,
  "created": "2025-11-23T12:01:48.558206",
  "modified": "2025-11-23T12:01:48.558206",
  "file_type": "code",
  "content_hash": "33722d500e8fd6096ab1083083eaa153",
  "content_type": "text",
  "content": "\"\"\"\nPerplexity AI API client for HyperCode.\nHandles communication with the Perplexity API.\n\"\"\"\n\nfrom typing import Dict, Optional\n\nimport requests\nfrom hypercode.config import Config\n\n\nclass PerplexityClient:\n    \"\"\"Client for interacting with Perplexity AI API\"\"\"\n\n    def __init__(self, api_key: Optional[str] = None):\n        \"\"\"Initialize the Perplexity client.\n\n        Args:\n            api_key: Optional API key. If not provided, will use the one from config.\n        \"\"\"\n        self.api_key = api_key or Config.PERPLEXITY_API_KEY\n        self.base_url = Config.PERPLEXITY_API_URL\n\n        if not self.api_key:\n            raise ValueError(\n                \"Perplexity API key not found. \"\n                \"Please set the PERPLEXITY_API_KEY environment variable.\"\n            )\n\n    def query(self, prompt: str, model: str = \"sonar-pro\") -> Dict:\n        \"\"\"Send a query to the Perplexity API.\n\n        Args:\n            prompt: The prompt to send to the API.\n            model: The model to use for the query.\n\n        Returns:\n            The API response as a dictionary.\n        \"\"\"\n        headers = {\n            \"Authorization\": f\"Bearer {self.api_key}\",\n            \"Content-Type\": \"application/json\",\n            \"accept\": \"application/json\",\n        }\n\n        payload = {\n            \"model\": model,\n            \"messages\": [\n                {\n                    \"role\": \"system\",\n                    \"content\": \"You are an AI assistant that helps with programming tasks. Be concise and helpful.\",\n                },\n                {\"role\": \"user\", \"content\": prompt},\n            ],\n            \"max_tokens\": 1000,\n            \"temperature\": 0.7,\n        }\n\n        try:\n            response = requests.post(\n                self.base_url, headers=headers, json=payload, timeout=30\n            )\n            response.raise_for_status()\n            return response.json()\n        except requests.exceptions.RequestException as e:\n            return {\n                \"error\": str(e),\n                \"status_code\": getattr(e.response, \"status_code\", None),\n            }\n\n\ndef test_connection():\n    \"\"\"Test the connection to the Perplexity API\"\"\"\n    try:\n        client = PerplexityClient()\n        response = client.query(\"Test connection\")\n        if \"error\" in response:\n            print(f\"Error: {response['error']}\")\n            return False\n        print(\"Successfully connected to Perplexity API!\")\n        return True\n    except Exception as e:\n        print(f\"Error testing Perplexity API connection: {e}\")\n        return False\n\n\nif __name__ == \"__main__\":\n    test_connection()\n",
  "metadata": {},
  "relative_path": "src\\hypercode\\perplexity_client.py",
  "id": "9d0c58198c06232d63d8554444e015b7"
}